<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Cheometry Dash</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Arial Black', Arial, sans-serif;
            overflow: hidden;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        }

        /* MEN√ö PRINCIPAL */
        #menu {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            z-index: 1000;
        }

        #logo {
            width: 400px;
            max-width: 80%;
            margin-bottom: 50px;
            filter: drop-shadow(0 10px 20px rgba(0,0,0,0.3));
            animation: float 3s ease-in-out infinite;
        }

        @keyframes float {
            0%, 100% { transform: translateY(0px); }
            50% { transform: translateY(-20px); }
        }

        .menu-buttons {
            display: flex;
            gap: 30px;
            align-items: center;
            margin-bottom: 30px;
        }

        .menu-btn {
            width: 120px;
            height: 120px;
            background: white;
            border: none;
            border-radius: 20px;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 10px 30px rgba(0,0,0,0.3);
            padding: 15px;
        }

        .menu-btn:hover {
            transform: translateY(-10px) scale(1.1);
            box-shadow: 0 15px 40px rgba(0,0,0,0.4);
        }

        .menu-btn:active {
            transform: translateY(-5px) scale(1.05);
        }

        .menu-btn img {
            width: 100%;
            height: 100%;
            object-fit: contain;
        }

        #playBtn {
            width: 150px;
            height: 150px;
            background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
        }

        .settings-btn {
            width: 100px;
            height: 100px;
        }

        /* SELECTOR DE NIVELES */
        #levelSelector {
            display: none;
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            z-index: 999;
            flex-direction: column;
            align-items: center;
            justify-content: center;
        }

        .level-card-container {
            position: relative;
            width: 500px;
            max-width: 90%;
            height: 300px;
        }

        .level-card {
            position: absolute;
            width: 100%;
            height: 100%;
            background: white;
            border-radius: 30px;
            padding: 30px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.4);
            display: none;
            flex-direction: column;
            transition: all 0.3s ease;
        }

        .level-card.active {
            display: flex;
            animation: slideIn 0.4s ease;
        }

        @keyframes slideIn {
            from {
                opacity: 0;
                transform: translateX(100px);
            }
            to {
                opacity: 1;
                transform: translateX(0);
            }
        }

        .level-header {
            display: flex;
            align-items: center;
            gap: 15px;
            margin-bottom: 20px;
        }

        .difficulty-emoji {
            font-size: 40px;
        }

        .level-name {
            font-size: 32px;
            color: #333;
            font-weight: bold;
        }

        .coins-info {
            font-size: 20px;
            color: #666;
            margin-bottom: 20px;
        }

        .progress-container {
            flex: 1;
            display: flex;
            flex-direction: column;
            justify-content: flex-end;
        }

        .progress-label {
            font-size: 16px;
            color: #888;
            margin-bottom: 10px;
        }

        .progress-bar {
            width: 100%;
            height: 30px;
            background: #e0e0e0;
            border-radius: 15px;
            overflow: hidden;
            margin-bottom: 20px;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #f093fb 0%, #f5576c 100%);
            transition: width 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: flex-end;
            padding-right: 10px;
            color: white;
            font-weight: bold;
        }

        .level-dots {
            display: flex;
            gap: 8px;
            justify-content: center;
        }

        .dot {
            width: 12px;
            height: 12px;
            border-radius: 50%;
            background: rgba(255,255,255,0.4);
            transition: all 0.3s ease;
        }

        .dot.active {
            background: white;
            transform: scale(1.3);
        }

        .nav-btn {
            position: absolute;
            top: 50%;
            transform: translateY(-50%);
            width: 60px;
            height: 60px;
            background: white;
            border: none;
            border-radius: 50%;
            cursor: pointer;
            font-size: 30px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.3);
            transition: all 0.3s ease;
            z-index: 10;
        }

        .nav-btn:hover {
            transform: translateY(-50%) scale(1.1);
            box-shadow: 0 8px 20px rgba(0,0,0,0.4);
        }

        .nav-btn.left {
            left: 20px;
        }

        .nav-btn.right {
            right: 20px;
        }

        .play-level-btn {
            width: 100%;
            padding: 15px;
            background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
            border: none;
            border-radius: 15px;
            color: white;
            font-size: 24px;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .play-level-btn:hover {
            transform: scale(1.05);
            box-shadow: 0 10px 30px rgba(0,0,0,0.3);
        }

        .back-btn {
            position: absolute;
            top: 30px;
            left: 30px;
            padding: 15px 30px;
            background: white;
            border: none;
            border-radius: 15px;
            font-size: 20px;
            font-weight: bold;
            cursor: pointer;
            box-shadow: 0 5px 15px rgba(0,0,0,0.3);
            transition: all 0.3s ease;
        }

        .back-btn:hover {
            transform: scale(1.1);
        }

        /* JUEGO 3D */
        #gameCanvas {
            display: none;
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
        }

        .game-ui {
            position: absolute;
            top: 20px;
            left: 50%;
            transform: translateX(-50%);
            color: white;
            font-size: 24px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.5);
            z-index: 100;
            display: none;
        }

        .game-over {
            display: none;
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: white;
            padding: 40px;
            border-radius: 30px;
            text-align: center;
            box-shadow: 0 20px 60px rgba(0,0,0,0.4);
            z-index: 200;
        }

        .game-over h2 {
            font-size: 48px;
            margin-bottom: 20px;
            color: #f5576c;
        }

        .game-over p {
            font-size: 24px;
            margin-bottom: 30px;
            color: #666;
        }

        .restart-btn, .menu-return-btn {
            padding: 15px 40px;
            margin: 0 10px;
            font-size: 20px;
            font-weight: bold;
            border: none;
            border-radius: 15px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .restart-btn {
            background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
            color: white;
        }

        .menu-return-btn {
            background: #e0e0e0;
            color: #333;
        }

        .restart-btn:hover, .menu-return-btn:hover {
            transform: scale(1.1);
        }

        /* MODAL */
        .modal {
            display: none;
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: white;
            padding: 40px;
            border-radius: 30px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.4);
            z-index: 1001;
            text-align: center;
            max-width: 500px;
        }

        .modal h2 {
            font-size: 36px;
            margin-bottom: 20px;
            color: #333;
        }

        .modal p {
            font-size: 18px;
            color: #666;
            line-height: 1.6;
        }

        .close-modal {
            margin-top: 20px;
            padding: 10px 30px;
            background: #667eea;
            color: white;
            border: none;
            border-radius: 10px;
            font-size: 18px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .close-modal:hover {
            transform: scale(1.1);
        }
    </style>
</head>
<body>
    <!-- MEN√ö PRINCIPAL -->
    <div id="menu">
        <img id="logo" src="CheometryDashLogo.png" alt="Cheometry Dash">
        
        <div class="menu-buttons">
            <button class="menu-btn" id="editBtn">
                <img src="Edit.png" alt="Edit">
            </button>
            <button class="menu-btn" id="playBtn">
                <img src="Play.png" alt="Play">
            </button>
        </div>
        
        <div class="menu-buttons">
            <button class="menu-btn settings-btn" id="settingsBtn">
                <img src="Settings.png" alt="Settings">
            </button>
            <button class="menu-btn settings-btn" id="creditsBtn">
                <img src="Credits.png" alt="Credits">
            </button>
        </div>
    </div>

    <!-- SELECTOR DE NIVELES -->
    <div id="levelSelector">
        <button class="back-btn" id="backToMenu">‚Üê Volver</button>
        
        <div class="level-card-container">
            <button class="nav-btn left" id="prevLevel">‚óÄ</button>
            <button class="nav-btn right" id="nextLevel">‚ñ∂</button>
            
            <div id="levelCards"></div>
        </div>
    </div>

    <!-- JUEGO 3D -->
    <div id="gameCanvas"></div>
    <div class="game-ui" id="gameUI">
        <div id="levelNameDisplay"></div>
        <div id="progressDisplay">Progreso: 0%</div>
    </div>

    <!-- GAME OVER -->
    <div class="game-over" id="gameOver">
        <h2 id="gameOverTitle">¬°Fallaste!</h2>
        <p id="gameOverProgress">Progreso: 0%</p>
        <button class="restart-btn" id="restartBtn">Reintentar</button>
        <button class="menu-return-btn" id="menuReturnBtn">Men√∫</button>
    </div>

    <!-- MODAL AJUSTES -->
    <div class="modal" id="settingsModal">
        <h2>‚öôÔ∏è Ajustes</h2>
        <p>Pr√≥ximamente: Control de volumen, efectos visuales y m√°s opciones de personalizaci√≥n.</p>
        <button class="close-modal" id="closeSettings">Cerrar</button>
    </div>

    <!-- MODAL CR√âDITOS -->
    <div class="modal" id="creditsModal">
        <h2>üéÆ Cr√©ditos</h2>
        <p>
            <strong>Cheometry Dash</strong><br><br>
            Desarrollado con ‚ù§Ô∏è<br>
            Motor gr√°fico: Three.js<br>
            Inspirado en Geometry Dash<br><br>
            ¬°Gracias por jugar!
        </p>
        <button class="close-modal" id="closeCredits">Cerrar</button>
    </div>

    <script>
        // DATOS DE NIVELES
        const levels = [
            { name: "Stereo Madness +", difficulty: "üòä", coins: 0, progress: 0, speed: 0.15, obstacles: 15, music: "StereoMadness.mp3" },
            { name: "Pack on Pack", difficulty: "üòä", coins: 0, progress: 0, speed: 0.17, obstacles: 18, music: "PackOnPack.mp3" },
            { name: "Totangeist", difficulty: "üòê", coins: 0, progress: 0, speed: 0.19, obstacles: 22, music: "Totangeist.mp3" },
            { name: "Ply out", difficulty: "üòê", coins: 0, progress: 0, speed: 0.21, obstacles: 25, music: "PlyOut.mp3" },
            { name: "Serm√≥n after Serm√≥n", difficulty: "üòê", coins: 0, progress: 0, speed: 0.23, obstacles: 28, music: "SermonAfterSermon.mp3" },
            { name: "Cant go out", difficulty: "üò†", coins: 0, progress: 0, speed: 0.25, obstacles: 32, music: "CantGoOut.mp3" },
            { name: "Toca C√©sped", difficulty: "üò†", coins: 0, progress: 0, speed: 0.27, obstacles: 35, music: "TocaCesped.mp3" },
            { name: "Time No Machine", difficulty: "üò†", coins: 0, progress: 0, speed: 0.29, obstacles: 38, music: "TimeNoMachine.mp3" },
            { name: "Aqu√≠ no hay Cycles", difficulty: "üò±", coins: 0, progress: 0, speed: 0.31, obstacles: 42, music: "AquiNoHayCycles.mp3" },
            { name: "XNotStep", difficulty: "üò±", coins: 0, progress: 0, speed: 0.33, obstacles: 45, music: "XNotStep.mp3" },
            { name: "PutterFunk", difficulty: "üò±", coins: 0, progress: 0, speed: 0.35, obstacles: 48, music: "PutterFunk.mp3" },
            { name: "Theory of the Big Bang", difficulty: "üò±", coins: 0, progress: 0, speed: 0.37, obstacles: 52, music: "TheoryOfTheBigBang.mp3" },
            { name: "Iker Adventures", difficulty: "üëπ", coins: 0, progress: 0, speed: 0.39, obstacles: 55, music: "IkerAdventures.mp3" },
            { name: "Electropinasticks", difficulty: "üëπ", coins: 0, progress: 0, speed: 0.41, obstacles: 58, music: "Electropinasticks.mp3" },
            { name: "FingerPam", difficulty: "üëπ", coins: 0, progress: 0, speed: 0.43, obstacles: 62, music: "FingerPam.mp3" },
            { name: "Dash", difficulty: "üëπ", coins: 0, progress: 0, speed: 0.5, obstacles: 70, music: "Dash.mp3" }
        ];

        let currentLevelIndex = 0;

        // M√öSICA
        function initMenuMusic() {
            if (!menuMusic) {
                menuMusic = new Audio('Menu.mp3');
                menuMusic.loop = true;
                menuMusic.volume = 0.5;
            }
        }

        function playMenuMusic() {
            initMenuMusic();
            if (levelMusic) {
                levelMusic.pause();
                levelMusic.currentTime = 0;
            }
            menuMusic.play().catch(e => console.log('Error playing menu music:', e));
        }

        function stopMenuMusic() {
            if (menuMusic) {
                menuMusic.pause();
            }
        }

        function playLevelMusic(musicFile) {
            stopMenuMusic();
            if (levelMusic) {
                levelMusic.pause();
            }
            levelMusic = new Audio(musicFile);
            levelMusic.loop = true;
            levelMusic.volume = 0.6;
            levelMusic.play().catch(e => console.log('Error playing level music:', e));
        }

        function stopLevelMusic() {
            if (levelMusic) {
                levelMusic.pause();
                levelMusic.currentTime = 0;
            }
        }

        // CREAR TARJETAS DE NIVELES
        function createLevelCards() {
            const container = document.getElementById('levelCards');
            levels.forEach((level, index) => {
                const card = document.createElement('div');
                card.className = 'level-card' + (index === 0 ? ' active' : '');
                card.innerHTML = `
                    <div class="level-header">
                        <span class="difficulty-emoji">${level.difficulty}</span>
                        <span class="level-name">${level.name}</span>
                    </div>
                    <div class="coins-info">ü™ô Monedas: ${level.coins}/3</div>
                    <div class="progress-container">
                        <div class="progress-label">Progreso del nivel</div>
                        <div class="progress-bar">
                            <div class="progress-fill" style="width: ${level.progress}%">
                                ${level.progress}%
                            </div>
                        </div>
                        <div class="level-dots">
                            ${levels.map((_, i) => `<div class="dot ${i === index ? 'active' : ''}"></div>`).join('')}
                        </div>
                        <button class="play-level-btn" onclick="startLevel(${index})">‚ñ∂ JUGAR</button>
                    </div>
                `;
                container.appendChild(card);
            });
        }

        // NAVEGACI√ìN DE NIVELES
        function showLevel(index) {
            const cards = document.querySelectorAll('.level-card');
            cards.forEach((card, i) => {
                card.classList.toggle('active', i === index);
            });
            currentLevelIndex = index;
        }

        document.getElementById('prevLevel').addEventListener('click', () => {
            currentLevelIndex = (currentLevelIndex - 1 + levels.length) % levels.length;
            showLevel(currentLevelIndex);
        });

        document.getElementById('nextLevel').addEventListener('click', () => {
            currentLevelIndex = (currentLevelIndex + 1) % levels.length;
            showLevel(currentLevelIndex);
        });

        // MEN√ö PRINCIPAL
        document.getElementById('playBtn').addEventListener('click', () => {
            document.getElementById('menu').style.display = 'none';
            document.getElementById('levelSelector').style.display = 'flex';
            stopMenuMusic();
        });

        document.getElementById('backToMenu').addEventListener('click', () => {
            document.getElementById('levelSelector').style.display = 'none';
            document.getElementById('menu').style.display = 'flex';
            playMenuMusic();
        });

        document.getElementById('settingsBtn').addEventListener('click', () => {
            document.getElementById('settingsModal').style.display = 'block';
        });

        document.getElementById('creditsBtn').addEventListener('click', () => {
            document.getElementById('creditsModal').style.display = 'block';
        });

        document.getElementById('closeSettings').addEventListener('click', () => {
            document.getElementById('settingsModal').style.display = 'none';
        });

        document.getElementById('closeCredits').addEventListener('click', () => {
            document.getElementById('creditsModal').style.display = 'none';
        });

        // JUEGO 3D CON THREE.JS
        let scene, camera, renderer, player, obstacles = [], ground;
        let gameRunning = false;
        let currentLevel;
        let gameSpeed = 0.1;
        let playerVelocity = 0;
        let isJumping = false;
        let distanceTraveled = 0;
        let levelLength = 100;
        let menuMusic, levelMusic;
        let isMouseDown = false;
        let isKeyDown = false;

        function startLevel(index) {
            currentLevel = levels[index];
            gameSpeed = currentLevel.speed;
            
            document.getElementById('levelSelector').style.display = 'none';
            document.getElementById('gameCanvas').style.display = 'block';
            document.getElementById('gameUI').style.display = 'block';
            document.getElementById('levelNameDisplay').textContent = currentLevel.name;
            
            playLevelMusic(currentLevel.music);
            initGame();
        }

        function initGame() {
            distanceTraveled = 0;
            obstacles = [];
            
            const container = document.getElementById('gameCanvas');
            container.innerHTML = '';

            scene = new THREE.Scene();
            scene.background = new THREE.Color(0x87ceeb);
            scene.fog = new THREE.Fog(0x87ceeb, 10, 50);

            camera = new THREE.PerspectiveCamera(75, window.innerWidth / window.innerHeight, 0.1, 1000);
            camera.position.x = 0;
            camera.position.y = 3;
            camera.position.z = 10;
            camera.lookAt(0, 0, 0);

            renderer = new THREE.WebGLRenderer({ antialias: true });
            renderer.setSize(window.innerWidth, window.innerHeight);
            renderer.shadowMap.enabled = true;
            container.appendChild(renderer.domElement);

            // Luces
            const ambLight = new THREE.AmbientLight(0xffffff, 0.6);
            scene.add(ambLight);

            const dirLight = new THREE.DirectionalLight(0xffffff, 0.8);
            dirLight.position.set(5, 10, 5);
            dirLight.castShadow = true;
            scene.add(dirLight);

            // Suelo
            const groundGeo = new THREE.PlaneGeometry(200, 10);
            const groundMat = new THREE.MeshLambertMaterial({ color: 0x4a90e2 });
            ground = new THREE.Mesh(groundGeo, groundMat);
            ground.rotation.x = -Math.PI / 2;
            ground.position.x = 50;
            ground.position.y = 0;
            ground.position.z = 0;
            ground.receiveShadow = true;
            scene.add(ground);

            // Jugador (cubo)
            const playerGeo = new THREE.BoxGeometry(1, 1, 1);
            const playerMat = new THREE.MeshLambertMaterial({ color: 0xff6b6b });
            player = new THREE.Mesh(playerGeo, playerMat);
            player.position.x = -3;
            player.position.y = 0.5;
            player.position.z = 0;
            player.castShadow = true;
            scene.add(player);

            // Crear obst√°culos
            createObstacles();

            gameRunning = true;
            gameLoop();
        }

        function createObstacles() {
            const colors = [0xffd93d, 0x6bcf7f, 0xff6b9d, 0x4ecdc4];
            
            for (let i = 0; i < currentLevel.obstacles; i++) {
                const type = Math.random() > 0.5 ? 'spike' : 'block';
                let obstacle;
                
                if (type === 'spike') {
                    const geo = new THREE.ConeGeometry(0.5, 1.5, 4);
                    const mat = new THREE.MeshLambertMaterial({ color: colors[Math.floor(Math.random() * colors.length)] });
                    obstacle = new THREE.Mesh(geo, mat);
                    obstacle.position.y = 0.75;
                } else {
                    const height = 1 + Math.random() * 2;
                    const geo = new THREE.BoxGeometry(1, height, 1);
                    const mat = new THREE.MeshLambertMaterial({ color: colors[Math.floor(Math.random() * colors.length)] });
                    obstacle = new THREE.Mesh(geo, mat);
                    obstacle.position.y = height / 2;
                }
                
                obstacle.position.x = 5 + i * (levelLength / currentLevel.obstacles);
                obstacle.position.y = obstacle.position.y;
                obstacle.position.z = 0;
                obstacle.castShadow = true;
                scene.add(obstacle);
                obstacles.push(obstacle);
            }
        }

        function gameLoop() {
            if (!gameRunning) return;

            // Mover obst√°culos y suelo hacia la izquierda
            obstacles.forEach(obs => {
                obs.position.x -= gameSpeed;
                
                if (obs.position.x < -15) {
                    obs.position.x = levelLength + 5;
                }

                // Colisi√≥n
                if (checkCollision(player, obs)) {
                    gameOver(false);
                }
            });

            ground.position.x -= gameSpeed;
            if (ground.position.x < -50) {
                ground.position.x = 50;
            }

            // F√≠sica del jugador
            if (isJumping) {
                playerVelocity -= 0.02;
                player.position.y += playerVelocity;

                if (player.position.y <= 0.5) {
                    player.position.y = 0.5;
                    isJumping = false;
                    playerVelocity = 0;
                }
            }
            
            // Saltar si se mantiene presionado (click o tecla)
            if ((isMouseDown || isKeyDown) && !isJumping && gameRunning) {
                isJumping = true;
                playerVelocity = 0.25;
            }

            // Rotaci√≥n del jugador
            player.rotation.z += 0.1;

            // Actualizar progreso
            distanceTraveled += gameSpeed;
            const progress = Math.min(Math.floor((distanceTraveled / levelLength) * 100), 100);
            document.getElementById('progressDisplay').textContent = `Progreso: ${progress}%`;

            if (progress >= 100) {
                gameOver(true);
            }

            renderer.render(scene, camera);
            requestAnimationFrame(gameLoop);
        }

        function checkCollision(player, obstacle) {
            const px = player.position.x;
            const py = player.position.y;
            const pz = player.position.z;
            
            const ox = obstacle.position.x;
            const oy = obstacle.position.y;
            const oz = obstacle.position.z;

            return Math.abs(px - ox) < 1 &&
                   Math.abs(py - oy) < 1 &&
                   Math.abs(pz - oz) < 0.5;
        }

        function gameOver(won) {
            gameRunning = false;
            stopLevelMusic();
            
            const progress = Math.floor((distanceTraveled / levelLength) * 100);
            
            if (won) {
                currentLevel.progress = 100;
                document.getElementById('gameOverTitle').textContent = 'üéâ ¬°Nivel Completado!';
            } else {
                if (progress > currentLevel.progress) {
                    currentLevel.progress = progress;
                }
                document.getElementById('gameOverTitle').textContent = 'üí• ¬°Fallaste!';
            }
            
            document.getElementById('gameOverProgress').textContent = `Progreso: ${progress}%`;
            document.getElementById('gameOver').style.display = 'block';
        }

        document.getElementById('restartBtn').addEventListener('click', () => {
            document.getElementById('gameOver').style.display = 'none';
            const container = document.getElementById('gameCanvas');
            container.innerHTML = '';
            playLevelMusic(currentLevel.music);
            initGame();
        });

        document.getElementById('menuReturnBtn').addEventListener('click', () => {
            document.getElementById('gameOver').style.display = 'none';
            document.getElementById('gameCanvas').style.display = 'none';
            document.getElementById('gameUI').style.display = 'none';
            document.getElementById('levelSelector').style.display = 'flex';
            
            stopLevelMusic();
            
            // Actualizar tarjeta del nivel
            const cards = document.querySelectorAll('.level-card');
            const card = cards[currentLevelIndex];
            const progressFill = card.querySelector('.progress-fill');
            progressFill.style.width = currentLevel.progress + '%';
            progressFill.textContent = currentLevel.progress + '%';
        });

        // Control de salto con teclado
        document.addEventListener('keydown', (e) => {
            if ((e.code === 'Space' || e.code === 'ArrowUp') && gameRunning) {
                isKeyDown = true;
            }
        });

        document.addEventListener('keyup', (e) => {
            if (e.code === 'Space' || e.code === 'ArrowUp') {
                isKeyDown = false;
            }
        });

        // Control de salto con mouse
        document.addEventListener('mousedown', () => {
            if (gameRunning) {
                isMouseDown = true;
            }
        });

        document.addEventListener('mouseup', () => {
            isMouseDown = false;
        });

        // Control de salto con touch (m√≥viles)
        document.addEventListener('touchstart', (e) => {
            if (gameRunning) {
                e.preventDefault();
                isMouseDown = true;
            }
        }, { passive: false });

        document.addEventListener('touchend', (e) => {
            e.preventDefault();
            isMouseDown = false;
        }, { passive: false });

        // Responsive
        window.addEventListener('resize', () => {
            if (camera && renderer) {
                camera.aspect = window.innerWidth / window.innerHeight;
                camera.updateProjectionMatrix();
                renderer.setSize(window.innerWidth, window.innerHeight);
            }
        });

        // Inicializar
        createLevelCards();
        
        // Reproducir m√∫sica del men√∫ al cargar
        window.addEventListener('load', () => {
            playMenuMusic();
        });
        
        // Permitir reproducir m√∫sica con cualquier interacci√≥n del usuario
        document.body.addEventListener('click', () => {
            if (document.getElementById('menu').style.display !== 'none') {
                playMenuMusic();
            }
        }, { once: true });
    </script>
</body>
</html>
